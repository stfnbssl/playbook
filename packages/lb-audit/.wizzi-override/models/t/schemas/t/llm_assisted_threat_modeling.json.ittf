$group
    { llm_assisted_threat_modeling
        $schema "http://json-schema.org/draft-07/schema#"
        title "Schema per il Threat Modeling Assistito da LLM"
        description "Schema JSON per raccogliere informazioni per il threat modeling assistito da LLM per una macchina IACS, allineato a IEC 62443-4-1 SM-3 e SAMM Maturity Level 3."
        type "object"
        { properties
            object( machine, Informazioni sulla macchina IACS.
                $append properties
                    string( name, Nome della macchina (es. 'Controllore Robot Industriale'). )
                    string( intended_use, Uso previsto (es. 'Controllo robot in manifattura'). )
                [ required
                    "name" 
                    "intended_use" 
            array_of_objects( components, Tipi di componenti nella macchina.
                $append properties
                    string( name, Nome del componente (es. 'Microcontrollore'). )
                    enum( type, Tipo di componente secondo IEC 62443-4-2. )
                        "embedded_device" 
                        "host_device" 
                        "network_device" 
                        "application" 
                    string( role, Ruolo nella macchina (es. 'Controllo motori'). )
                    array_of_strings( interfaces, Interfacce (es. 'Modbus/TCP'). )
                    array_of_objects( data_flows )
                        $append properties
                            string( from, Origine del flusso (es. 'Onboard Server'). )
                            string( to, Destinazione del flusso (es. 'Microcontroller'). )
                            string( protocol, Protocollo (es. 'Modbus/TCP'). )
                            string( security, Meccanismo di sicurezza (es. 'TLS 1.3'). )
                        $append object
                            [ required
                                "from" 
                                "to" 
                                "protocol" 
                                "security" 
                $append object
                    [ required
                        "name" 
                        "type" 
                        "role" 
                        "interfaces" 
                        "data_flows" 
                minItems 1
            object( llm_configuration, Configurazione per l'LLM utilizzato nel threat modeling. )
                $append properties
                    string( model, Nome del modello LLM (es. 'Grok 3', 'GPT-4'). )
                    string( api_endpoint, Endpoint API dell'LLM (es. 'https://api.xai.com/grok'). )
                    string( prompt_template, Template del prompt per l'LLM. )
                    array_of_strings( threat_library, Fonti di threat intelligence (es. 'MITRE ATT&CK ICS'). )
                [ required
                    "model" 
                    "api_endpoint" 
                    "prompt_template" 
                    "threat_library" 
            array_of_objects( threat_model, Risultati del threat modeling per ciascun componente. )
                $append properties
                    string( component_name, Nome del componente. )
                    array_of_objects( threats
                        $append properties
                            string( threat_type, Tipo di minaccia (es. 'Tampering'). )
                            string( description, Descrizione della minaccia. )
                            string( cr_mapping, CR di IEC 62443-4-2 (es. 'CR 3.2'). )
                            string( mitigation, Mitigazione proposta. )
                            enum( risk_level, Livello di rischio. )
                                "Low" 
                                "Medium" 
                                "High" 
                            enum( sl_c, Livello di sicurezza delle capacit√†. )
                                "SL-C 0" 
                                "SL-C 1" 
                                "SL-C 2" 
                                "SL-C 3" 
                                "SL-C 4" 
                            string( metric, Metrica quantitativa (es. 'Detection < 10ms'). )
                        $append object
                            [ required
                                "threat_type" 
                                "description" 
                                "cr_mapping" 
                                "mitigation" 
                                "risk_level" 
                                "sl_c" 
                                "metric" 
                $append object
                    [ required
                        "component_name" 
                        "threats" 
                minItems 1
        [ required
            "machine" 
            "components" 
            "llm_configuration" 
            "threat_model" 
