txt 
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-8"
    task_name: "Mission or Business Focus"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-9"
    task_name: "System Stakeholders"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-10"
    task_name: "Asset Identification"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-11"
    task_name: "Authorization Boundary"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-12"
    task_name: "Information Types"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-13"
    task_name: "Information Life Cycle"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-14"
    task_name: "Risk Assessment (System)"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-15"
    task_name: "Requirements Definition"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-16"
    task_name: "Enterprise Architecture"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-17"
    task_name: "Requirements Allocation"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.
    ========== 
    [MODALITÀ] 
    context_mode: "task"
    task_id: "P-18"
    task_name: "System Registration"
    [CONTESTO (SLICE)]
    context_input: {"authorization_boundary":{"responsibilities":[{"subject":"patch firmware","owner":"OEM","notes":"Erogate via finestra manutenzione"},{"subject":"account management","owner":"Customer","notes":"Creazione/rotazione account operatori"},{"subject":"telemetria cloud","owner":"ThirdParty","notes":"Contratto con Provider Z"}]},"stakeholders":[{"name":"OEM Service","role":"manutentore","responsibilities":["patch firmware","accesso remoto sicuro"]},{"name":"OT Manager Cliente","role":"proprietario asset","responsibilities":["segmentazione rete","account operatore"]},{"name":"Cloud Provider Z","role":"telemetria","responsibilities":["hosting dati telemetria"]}]}
    ⚠️ Istruzione importante:
    Devi restituire SOLO JSON valido conforme allo schema seguente:
    {"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://example.com/schemas/rmf-oem-brainstorming.schema.json","title":"RMF OEM Brainstorming Output","description":"Struttura di output JSON per brainstorming LLM su minacce, requisiti e controlli (IEC 62443 / NIST 800-53/82) in fase Prepare del RMF (P-8…P-18) per macchine/sistemi OEM ICS/OT.","type":"object","additionalProperties":false,"required":["meta","context","results"],"properties":{"meta":{"type":"object","description":"Metadati del documento generato.","required":["version","generated_at","generator"],"properties":{"version":{"type":"string","description":"Versione dello schema logico del documento (non dello schema JSON). Esempio: '1.0.0'."},"generated_at":{"type":"string","format":"date-time","description":"Timestamp ISO 8601 della generazione."},"generator":{"type":"object","description":"Informazioni sull'agente/modello che ha prodotto l'output.","required":["name"],"properties":{"name":{"type":"string","description":"Nome o identificativo del modello/LLM."},"version":{"type":"string","description":"Versione del modello se disponibile."}},"additionalProperties":true},"scope_note":{"type":"string","description":"Nota sul perimetro di utilizzo: brainstorming non vincolante, da validare in sede di risk assessment formale."}}},"context":{"type":"object","description":"Contesto di input (riassunto dei dati forniti nel prompt).","required":["system_overview","oem_responsibility","rmf_tasks_considered"],"properties":{"system_overview":{"type":"object","description":"Descrizione ad alto livello della macchina/sistema.","required":["name","mission","functions"],"properties":{"name":{"type":"string","description":"Nome o codice macchina/sistema."},"mission":{"type":"string","description":"Mission/business focus (P-8): processi e obiettivi che la macchina supporta."},"functions":{"type":"array","description":"Funzioni principali della macchina.","items":{"type":"string"},"minItems":1},"deployment":{"type":"string","enum":["offsite","onsite","hybrid"],"description":"Stato previsto/attuale del sistema rispetto al sito del cliente."}}},"stakeholders":{"type":"array","description":"Stakeholder rilevanti (P-9) con ruolo.","items":{"$ref":"#/$defs/stakeholder"}},"assets":{"type":"array","description":"Asset identificati (P-10).","items":{"$ref":"#/$defs/asset"}},"information_types":{"type":"array","description":"Tipi di informazione trattati (P-12).","items":{"$ref":"#/$defs/informationType"}},"interfaces":{"type":"array","description":"Interfacce/connessioni (reti OT/IT, cloud, API) e protocolli.","items":{"$ref":"#/$defs/interface"}},"authorization_boundary":{"type":"object","description":"Confine di autorizzazione (P-11) e ripartizione responsabilità.","required":["in_scope","out_of_scope","responsibility_matrix"],"properties":{"in_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi sotto responsabilità OEM."},"out_of_scope":{"type":"array","items":{"type":"string"},"description":"Componenti/processi in responsabilità cliente/terzi."},"responsibility_matrix":{"type":"array","description":"Matrice sintetica di allocazione responsabilità (P-17).","items":{"$ref":"#/$defs/responsibility"}}}},"rmf_tasks_considered":{"type":"array","description":"Elenco task RMF P-8…P-18 coperti nell’input.","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"},"minItems":1,"uniqueItems":true}}},"results":{"type":"object","description":"Risultati del brainstorming: minacce, requisiti, controlli e parametri.","required":["threat_scenarios"],"properties":{"threat_scenarios":{"type":"array","description":"Elenco di scenari di minaccia mappati a requisiti e controlli.","items":{"$ref":"#/$defs/threatScenario"},"minItems":1},"summary":{"type":"object","description":"Sintesi quantitativa/qualitativa.","properties":{"top_risks":{"type":"array","description":"ID degli scenari a rischio più alto (ordinati).","items":{"type":"string"},"uniqueItems":true},"coverage":{"type":"object","description":"Copertura per task RMF e per standard.","properties":{"rmf_tasks_covered":{"type":"array","items":{"type":"string","pattern":"^P-(8|9|1[0-8])$"}},"standards_touched":{"type":"array","items":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"]}}}}}}}}},"$defs":{"stakeholder":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string","description":"Nome o funzione (es. OEM Service, Cliente OT, Fornitore Cloud)."},"role":{"type":"string","description":"Ruolo sintetico (es. proprietario asset, manutentore, DPO, CISO cliente)."},"responsibilities":{"type":"array","items":{"type":"string"},"description":"Responsabilità chiave lato sicurezza/privacy."}},"additionalProperties":false},"asset":{"type":"object","required":["id","name","type"],"properties":{"id":{"type":"string","description":"ID univoco asset."},"name":{"type":"string","description":"Nome asset (es. PLC-1, HMI-2)."},"type":{"type":"string","enum":["hardware","software","firmware","network","data","documentation","service"],"description":"Tipologia asset."},"criticality":{"type":"string","enum":["low","moderate","high","very_high"],"description":"Criticità per missione/sicurezza."}},"additionalProperties":false},"informationType":{"type":"object","required":["name","sensitivity"],"properties":{"name":{"type":"string","description":"Tipo informativo (es. ricette, log operativi, dati badge)."},"sensitivity":{"type":"string","enum":["public","internal","restricted","confidential","personal"],"description":"Classificazione sintetica."},"lifecycle_stages":{"type":"array","description":"Fasi del ciclo di vita (P-13) applicabili.","items":{"type":"string","enum":["collection","processing","storage","transmission","retention","disposal"]}}},"additionalProperties":false},"interface":{"type":"object","required":["name","protocols"],"properties":{"name":{"type":"string","description":"Interfaccia/connessione (es. OT-LAN, VPN manutenzione, API cloud)."},"protocols":{"type":"array","items":{"type":"string"},"description":"Protocolli utilizzati (es. Modbus/TCP, OPC UA, HTTPS/TLS)."},"exposure":{"type":"string","enum":["internal","site-perimeter","external"],"description":"Esposizione logica dell'interfaccia."}},"additionalProperties":false},"responsibility":{"type":"object","required":["subject","area","owner"],"properties":{"subject":{"type":"string","description":"Oggetto/attività (es. patch firmware, gestione account, monitoraggio log)."},"area":{"type":"string","enum":["OEM","Customer","ThirdParty"],"description":"Chi realizza/gestisce."},"owner":{"type":"string","description":"Ruolo/ente specifico (es. OEM Service, OT Manager Cliente)."}},"additionalProperties":false},"controlRef":{"type":"object","description":"Riferimento a controllo di standard.","required":["standard","id"],"properties":{"standard":{"type":"string","enum":["IEC 62443-3-3","IEC 62443-4-2","NIST 800-53","NIST 800-82"],"description":"Standard di riferimento."},"id":{"type":"string","description":"Identificativo controllo (es. 'SR 5.2', 'CR 1.2', 'AC-2').","pattern":"^(SR \\\\d+(\\\\.\\\\d+)?|CR \\\\d+(\\\\.\\\\d+)?|[A-Z]{2,3}-\\\\d{1,3}(/[A-Z]\\\\d*)?)$"},"note":{"type":"string","description":"Nota contestuale o scopo del controllo."}},"additionalProperties":false},"parameter":{"type":"object","description":"Parametro operativo da istanziare per un controllo/requisito.","required":["name","value"],"properties":{"name":{"type":"string","description":"Nome parametro (es. password_min_length, tls_version_min)."},"value":{"type":["string","number","integer","boolean"],"description":"Valore del parametro (es. 12, 'TLS1.2', true)."},"unit":{"type":"string","description":"Unità di misura se pertinente (es. 'days', 'chars')."},"rationale":{"type":"string","description":"Motivazione operativa/del rischio."}},"additionalProperties":false},"requirement":{"type":"object","description":"Requisito di protezione derivato dal rischio/minaccia.","required":["id","statement"],"properties":{"id":{"type":"string","description":"ID locale requisito (es. REQ-001)."},"statement":{"type":"string","description":"Testo del requisito."},"controls":{"type":"array","description":"Mappatura ai controlli degli standard.","items":{"$ref":"#/$defs/controlRef"},"minItems":1},"parameters":{"type":"array","description":"Parametri consigliati/istanziati per implementare il requisito.","items":{"$ref":"#/$defs/parameter"}}},"additionalProperties":false},"riskScore":{"type":"object","description":"Valutazione di rischio preliminare.","required":["likelihood","impact_c","impact_i","impact_a","method"],"properties":{"method":{"type":"string","enum":["qualitative-1to5","cvss-like","custom"],"description":"Metodologia di scoring usata."},"likelihood":{"type":"integer","minimum":1,"maximum":5,"description":"Probabilità (1..5) preliminare."},"impact_c":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Confidentiality (0..5)."},"impact_i":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Integrity (0..5)."},"impact_a":{"type":"integer","minimum":0,"maximum":5,"description":"Impatto su Availability (0..5)."},"score":{"type":"number","description":"Punteggio complessivo opzionale (es. L * max(C,I,A) o formula personalizzata)."},"rationale":{"type":"string","description":"Sintesi delle ragioni del punteggio."}},"additionalProperties":false},"taskLink":{"type":"object","description":"Collegamento alla/e risultanza/e RMF P-8…P-18 da cui deriva lo scenario.","required":["task_id"],"properties":{"task_id":{"type":"string","pattern":"^P-(8|9|1[0-8])$","description":"Task RMF di riferimento."},"note":{"type":"string","description":"Nota su come il task ha informato lo scenario."}},"additionalProperties":false},"threatScenario":{"type":"object","required":["id","title","assets","threat","vulnerabilities","consequences","requirements","risk"],"properties":{"id":{"type":"string","description":"ID univoco scenario (es. TSC-001)."},"title":{"type":"string","description":"Titolo sintetico dello scenario."},"assets":{"type":"array","description":"Riferimenti asset coinvolti.","items":{"type":"string"},"minItems":1},"threat":{"type":"object","required":["category","description"],"properties":{"category":{"type":"string","enum":["malware","unauthorized-access","man-in-the-middle","misconfiguration","supply-chain","physical","insider","denial-of-service","data-exfiltration","safety-impact","other"],"description":"Categoria minaccia."},"description":{"type":"string","description":"Descrizione specifica della minaccia."},"stride":{"type":"array","items":{"type":"string","enum":["S","T","R","I","D","E"]},"description":"Tag STRIDE opzionali."}}},"vulnerabilities":{"type":"array","description":"Vulnerabilità/condizioni abilitanti.","items":{"type":"string"}},"consequences":{"type":"array","description":"Conseguenze potenziali (business/safety/privacy).","items":{"type":"string"}},"task_links":{"type":"array","description":"Collegamenti ai task RMF che supportano/derivano lo scenario.","items":{"$ref":"#/$defs/taskLink"}},"requirements":{"type":"array","description":"Requisiti di protezione derivati per mitigare lo scenario.","items":{"$ref":"#/$defs/requirement"},"minItems":1},"risk":{"$ref":"#/$defs/riskScore"},"confidence":{"type":"string","enum":["low","moderate","high"],"description":"Confidenza dell’LLM nella pertinenza dello scenario."},"assumptions":{"type":"array","description":"Assunzioni fatte dall’LLM (da validare).","items":{"type":"string"}},"notes":{"type":"string","description":"Note operative aggiuntive o rischi residui."}},"additionalProperties":false}}} 
    [REGOLE] 
    - Usa solo le informazioni in context_input + system_core.
    - Se mancano dati necessari, NON inventare: compila "assumptions" e "missing_fields".
    - Riempi i campi "task_links" con {"task_id": "P-10"}.
    [Linee guida]
    - Popola "context" con i dati forniti sopra (senza inventare).
    - Genera almeno 3 threat_scenarios in "results".
    - Ogni scenario deve includere ≥1 requirement con controlli associati.
    - Istanzia parametri concreti quando possibile (es. password_min_length=12).
    - Compila "risk" con scala 1..5 e motivazione.
    - Usa ID coerenti (es. TSC-###, REQ-###).
    - Non includere testo fuori dal JSON.
    ⚠️ Restituisci SOLO JSON valido conforme allo schema di output definito in precedenza.