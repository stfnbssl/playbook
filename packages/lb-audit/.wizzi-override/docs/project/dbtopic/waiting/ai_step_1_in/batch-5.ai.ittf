ai dbtopic.step_1
    api-url http://localhost:3000
    call Dalla componentistica al sistema: **integrare ‑4‑2 con ‑3‑3**
        llm_service grok
        llm_model grok-3
        max_tokens 8192
        temperature 0.2
        description normative_e_standard - Dalla componentistica al sistema: **integrare ‑4‑2 con ‑3‑3**
        message 
            role system
            content 
                \n Sei un assistente che genera SOLO JSON UTF-8 valido, senza testo fuori dal JSON.
                \n Sei un esperto di cybersecurity in contesto OT/ICS
                \n Conosci particolarmente bene lo standard di sicurezza IEC 62443.
                \n Conosci anche IEC 27001/2, Nis2, CRA, Direttiva macchine 2006, Registro Macchine 2023 e GDPR 2016.
        message 
            role user
            content 
                \n Genera il “DB Argomenti” seguendo lo schema richiesto. Parametri:
                \n meta:
                \n db_name: "DB Argomenti OT/ICS Cybersecurity"
                \n version: "0.1"
                \n language: "it-IT"
                \n notes: "Database orientato a oggetti su tre livelli. Contenuti ad alto livello con placeholders di contesto."
                \n ambito:
                \n id: "cap/4"
                \n nome: "Ciclo di vita della sicurezza IACS (IEC 62443‑3‑2, ‑3‑3)"
                \n sezione:
                \n id: "cap/4/4.4"
                \n nome: "Dalla componentistica al sistema: **integrare ‑4‑2 con ‑3‑3**"
                \n descrizione:
                    \n **Passi** 
                    \n * **Raccolta dichiarazioni OEM**: capacità FR/SL, **SBOM**, policy update/PSIRT.
                    \n * **Selezione**: confronto requisiti di componente vs **SR** di zona.
                    \n * **Integrazione**: hardening, account/service minimi, update sicuri, logging.
                    \n * **Verifica**: test specifici di integrazione e performance in OT.
                    \n **Figure/Template (segnaposto)**
                    \n * **Tabella [section]**: matrice **SR (‑3‑3) ↔ capability (‑4‑2)**.
                \n obiettivo:
                    \n Usare componenti/OEM con capacità **62443‑4‑2** e integrarli in un sistema conforme ai **SR ‑3‑3**.
                \n prompt_base:
                    \n Scrivi 8–10 righe che spieghino come usare componenti con requisiti **‑4‑2** per comporre un sistema che soddisfi i **SR** **‑3‑3**.
                \n Popola questo schema
                \n <output_schema>
                \n {"$schema":"http://json-schema.org/draft-07/schema#","type":"object","additionalProperties":false,"required":["meta","ambito"],"properties":{"meta":{"type":"object","additionalProperties":false,"required":["db_name","version","last_updated","language","notes"],"properties":{"db_name":{"type":"string"},"version":{"type":"string"},"last_updated":{"type":"string"},"language":{"type":"string"},"notes":{"type":"string"}}},"ambito":{"type":"object","additionalProperties":false,"required":["id","nome","ruolo","descrizione","sezioni"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"ruolo":{"type":"string"},"norme_riferimento":{"type":"array","items":{"type":"string"}},"descrizione":{"type":"string"},"sezioni":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/sezione"}}}}},"$defs":{"sezione":{"type":"object","additionalProperties":false,"required":["id","nome","obiettivo","output_attesi","prompt_base","aspetti_di_sicurezza","policy_template","sop_template","repo_branching_model","raci","parametri_generazione","prompting","checklist","campi_contesto_richiesti_per_la_contestualizzazione","avvertenze"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"obiettivo":{"type":"object","additionalProperties":false,"required":["codice","descrizione"],"properties":{"codice":{"type":"string"},"descrizione":{"type":"string"}}},"output_attesi":{"type":"array","items":{"type":"string"}},"prompt_base":{"type":"string"},"aspetti_di_sicurezza":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/aspetto"}},"policy_template":{"$ref":"#/$defs/policy_template"},"sop_template":{"$ref":"#/$defs/sop_template"},"repo_branching_model":{"type":"object","additionalProperties":false,"required":["modello","regole"],"properties":{"modello":{"type":"string"},"regole":{"type":"array","items":{"type":"string"}}}},"raci":{"type":"object","additionalProperties":false,"required":["roles","matrix"],"properties":{"roles":{"type":"array","minItems":1,"items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["attivita"],"properties":{"attivita":{"type":"string"},"SP":{"type":"string"},"AO":{"type":"string"},"SI":{"type":"string"},"OTSec":{"type":"string"}}}}}},"parametri_generazione":{"type":"object","additionalProperties":false,"required":["tipi_documento_supportati","audience_possibili","stili","livello_tecnico","vincoli"],"properties":{"tipi_documento_supportati":{"type":"array","items":{"type":"string"}},"audience_possibili":{"type":"array","items":{"type":"string"}},"stili":{"type":"array","items":{"type":"string"}},"livello_tecnico":{"type":"array","items":{"type":"string"}},"vincoli":{"type":"array","items":{"type":"string"}}}},"prompting":{"type":"object","additionalProperties":false,"required":["prompt_template_generico","prompt_esempio_articolo","prompt_esempio_slide","prompt_esempio_sop"],"properties":{"prompt_template_generico":{"type":"string"},"prompt_esempio_articolo":{"type":"string"},"prompt_esempio_slide":{"type":"string"},"prompt_esempio_sop":{"type":"string"}}},"checklist":{"type":"array","items":{"type":"string"}},"campi_contesto_richiesti_per_la_contestualizzazione":{"type":"array","items":{"type":"string"}},"avvertenze":{"type":"array","items":{"type":"string"}}}},"aspetto":{"type":"object","additionalProperties":false,"required":["id","titolo","descrizione_astratta","rischi_mitigati","pratiche_raccomandate","metriche_kpi","artefatti","placeholders_contesto"],"properties":{"id":{"type":"string"},"titolo":{"type":"string"},"descrizione_astratta":{"type":"string"},"rischi_mitigati":{"type":"array","items":{"type":"string"}},"pratiche_raccomandate":{"type":"array","items":{"type":"string"}},"metriche_kpi":{"type":"array","items":{"type":"string"}},"artefatti":{"type":"object","additionalProperties":false,"required":["procedure","registri","evidenze"],"properties":{"procedure":{"type":"array","items":{"type":"string"}},"registri":{"type":"array","items":{"type":"string"}},"evidenze":{"type":"array","items":{"type":"string"}}}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"policy_template":{"type":"object","additionalProperties":false,"required":["titolo","sezioni","placeholders_contesto"],"properties":{"titolo":{"type":"string"},"sezioni":{"type":"array","items":{"type":"string"}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"sop_template":{"type":"object","additionalProperties":false,"required":["titolo","step","registrazioni"],"properties":{"titolo":{"type":"string"},"step":{"type":"array","items":{"type":"string"}},"registrazioni":{"type":"array","items":{"type":"string"}}}}}}
                \n </output_schema>
    call Artefatti & Evidenze (deliverable)
        llm_service grok
        llm_model grok-3
        max_tokens 8192
        temperature 0.2
        description normative_e_standard - Artefatti & Evidenze (deliverable)
        message 
            role system
            content 
                \n Sei un assistente che genera SOLO JSON UTF-8 valido, senza testo fuori dal JSON.
                \n Sei un esperto di cybersecurity in contesto OT/ICS
                \n Conosci particolarmente bene lo standard di sicurezza IEC 62443.
                \n Conosci anche IEC 27001/2, Nis2, CRA, Direttiva macchine 2006, Registro Macchine 2023 e GDPR 2016.
        message 
            role user
            content 
                \n Genera il “DB Argomenti” seguendo lo schema richiesto. Parametri:
                \n meta:
                \n db_name: "DB Argomenti OT/ICS Cybersecurity"
                \n version: "0.1"
                \n language: "it-IT"
                \n notes: "Database orientato a oggetti su tre livelli. Contenuti ad alto livello con placeholders di contesto."
                \n ambito:
                \n id: "cap/4"
                \n nome: "Ciclo di vita della sicurezza IACS (IEC 62443‑3‑2, ‑3‑3)"
                \n sezione:
                \n id: "cap/4/4.5"
                \n nome: "Artefatti & Evidenze (deliverable)"
                \n descrizione:
                    \n * **Mappa Zone/Conduits** e confini IT/OT (con **DMZ**).
                    \n * **Matrice SL‑Target** per zona × **FR1–FR7**.
                    \n * Elenco **SR (‑3‑3)** per zona + policy conduits.
                    \n * **Piano di test** (FAT/SAT), report di verifica e **baseline** di hardening.
                    \n * **Registro change** e **registro eccezioni** con compensazioni.
                    \n * **Dashboard KPI** e verbali di riesame.
                \n Popola questo schema
                \n <output_schema>
                \n {"$schema":"http://json-schema.org/draft-07/schema#","type":"object","additionalProperties":false,"required":["meta","ambito"],"properties":{"meta":{"type":"object","additionalProperties":false,"required":["db_name","version","last_updated","language","notes"],"properties":{"db_name":{"type":"string"},"version":{"type":"string"},"last_updated":{"type":"string"},"language":{"type":"string"},"notes":{"type":"string"}}},"ambito":{"type":"object","additionalProperties":false,"required":["id","nome","ruolo","descrizione","sezioni"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"ruolo":{"type":"string"},"norme_riferimento":{"type":"array","items":{"type":"string"}},"descrizione":{"type":"string"},"sezioni":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/sezione"}}}}},"$defs":{"sezione":{"type":"object","additionalProperties":false,"required":["id","nome","obiettivo","output_attesi","prompt_base","aspetti_di_sicurezza","policy_template","sop_template","repo_branching_model","raci","parametri_generazione","prompting","checklist","campi_contesto_richiesti_per_la_contestualizzazione","avvertenze"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"obiettivo":{"type":"object","additionalProperties":false,"required":["codice","descrizione"],"properties":{"codice":{"type":"string"},"descrizione":{"type":"string"}}},"output_attesi":{"type":"array","items":{"type":"string"}},"prompt_base":{"type":"string"},"aspetti_di_sicurezza":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/aspetto"}},"policy_template":{"$ref":"#/$defs/policy_template"},"sop_template":{"$ref":"#/$defs/sop_template"},"repo_branching_model":{"type":"object","additionalProperties":false,"required":["modello","regole"],"properties":{"modello":{"type":"string"},"regole":{"type":"array","items":{"type":"string"}}}},"raci":{"type":"object","additionalProperties":false,"required":["roles","matrix"],"properties":{"roles":{"type":"array","minItems":1,"items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["attivita"],"properties":{"attivita":{"type":"string"},"SP":{"type":"string"},"AO":{"type":"string"},"SI":{"type":"string"},"OTSec":{"type":"string"}}}}}},"parametri_generazione":{"type":"object","additionalProperties":false,"required":["tipi_documento_supportati","audience_possibili","stili","livello_tecnico","vincoli"],"properties":{"tipi_documento_supportati":{"type":"array","items":{"type":"string"}},"audience_possibili":{"type":"array","items":{"type":"string"}},"stili":{"type":"array","items":{"type":"string"}},"livello_tecnico":{"type":"array","items":{"type":"string"}},"vincoli":{"type":"array","items":{"type":"string"}}}},"prompting":{"type":"object","additionalProperties":false,"required":["prompt_template_generico","prompt_esempio_articolo","prompt_esempio_slide","prompt_esempio_sop"],"properties":{"prompt_template_generico":{"type":"string"},"prompt_esempio_articolo":{"type":"string"},"prompt_esempio_slide":{"type":"string"},"prompt_esempio_sop":{"type":"string"}}},"checklist":{"type":"array","items":{"type":"string"}},"campi_contesto_richiesti_per_la_contestualizzazione":{"type":"array","items":{"type":"string"}},"avvertenze":{"type":"array","items":{"type":"string"}}}},"aspetto":{"type":"object","additionalProperties":false,"required":["id","titolo","descrizione_astratta","rischi_mitigati","pratiche_raccomandate","metriche_kpi","artefatti","placeholders_contesto"],"properties":{"id":{"type":"string"},"titolo":{"type":"string"},"descrizione_astratta":{"type":"string"},"rischi_mitigati":{"type":"array","items":{"type":"string"}},"pratiche_raccomandate":{"type":"array","items":{"type":"string"}},"metriche_kpi":{"type":"array","items":{"type":"string"}},"artefatti":{"type":"object","additionalProperties":false,"required":["procedure","registri","evidenze"],"properties":{"procedure":{"type":"array","items":{"type":"string"}},"registri":{"type":"array","items":{"type":"string"}},"evidenze":{"type":"array","items":{"type":"string"}}}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"policy_template":{"type":"object","additionalProperties":false,"required":["titolo","sezioni","placeholders_contesto"],"properties":{"titolo":{"type":"string"},"sezioni":{"type":"array","items":{"type":"string"}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"sop_template":{"type":"object","additionalProperties":false,"required":["titolo","step","registrazioni"],"properties":{"titolo":{"type":"string"},"step":{"type":"array","items":{"type":"string"}},"registrazioni":{"type":"array","items":{"type":"string"}}}}}}
                \n </output_schema>
    call Figure & Template (riepilogo segnaposto)
        llm_service grok
        llm_model grok-3
        max_tokens 8192
        temperature 0.2
        description normative_e_standard - Figure & Template (riepilogo segnaposto)
        message 
            role system
            content 
                \n Sei un assistente che genera SOLO JSON UTF-8 valido, senza testo fuori dal JSON.
                \n Sei un esperto di cybersecurity in contesto OT/ICS
                \n Conosci particolarmente bene lo standard di sicurezza IEC 62443.
                \n Conosci anche IEC 27001/2, Nis2, CRA, Direttiva macchine 2006, Registro Macchine 2023 e GDPR 2016.
        message 
            role user
            content 
                \n Genera il “DB Argomenti” seguendo lo schema richiesto. Parametri:
                \n meta:
                \n db_name: "DB Argomenti OT/ICS Cybersecurity"
                \n version: "0.1"
                \n language: "it-IT"
                \n notes: "Database orientato a oggetti su tre livelli. Contenuti ad alto livello con placeholders di contesto."
                \n ambito:
                \n id: "cap/4"
                \n nome: "Ciclo di vita della sicurezza IACS (IEC 62443‑3‑2, ‑3‑3)"
                \n sezione:
                \n id: "cap/4/4.6"
                \n nome: "Figure & Template (riepilogo segnaposto)"
                \n descrizione:
                    \n * Figura 4.1 — Mappa Zone/Conduits (iniziale).
                    \n * Tabella 4.1 — **Zona × FR (SL‑Target)**.
                    \n * Figura 4.2 — Architettura target con **DMZ** e conduits.
                    \n * Tabella 4.2 — **SR (‑3‑3)** per zona (mapping **FR/SL**).
                    \n * Figura 4.3 — Ciclo **test → esercizio → miglioramento**.
                    \n * Tabella 4.4 — **SR (‑3‑3) ↔ capability (‑4‑2)**.
                    \n * Template — Registro rischi; Piano FAT/SAT; Registro change; Dashboard KPI.
                    \n ## Glossario minimo (Cap. 4)
                    \n * **IACS/OT**: sistemi di automazione e controllo industriale; ambiente operativo di fabbrica/impianto.
                    \n * **Zona (Zone)**: insieme di asset OT con profilo di rischio simile, separati logicamente da altre zone.
                    \n * **Conduit**: canale di comunicazione **controllato** tra zone; filtra protocolli e direzioni dei flussi.
                    \n * **SL — Security Level (SL0–SL4)**: obiettivo di robustezza **per requisito** e **per zona/conduit/asset**.
                    \n * **FR — Foundational Requirements**: 7 aree di controllo (FR1–FR7) dalla gestione delle identità al ripristino.
                    \n * **DMZ**: zona demilitarizzata industriale, cuscinetto tra IT e OT.
                    \n * **FAT/SAT**: collaudo in fabbrica/sito (Factory/Site Acceptance Test).
                    \n * **SR (System Requirements)**: requisiti di sistema secondo **IEC 62443‑3‑3**.
                    \n * **PSIRT/SBOM**: team risposta vulnerabilità di prodotto / distinta componenti software.
                    \n ## Checklist finale (QA redazionale — Cap. 4)
                    \n * [ ] Acronomi spiegati e tecnicismi parafrasati.
                    \n * [ ] Box **Per i ruoli** in ogni sezione.
                    \n * [ ] **SL‑Target** per zona con mapping **FR1–FR7**.
                    \n * [ ] **SR (‑3‑3)** derivati dagli SL‑Target e tracciati.
                    \n * [ ] Figure/template elencati e coerenti.
                    \n * [ ] Takeaway + **avvertenza safety** per sezione.
                    \n * [ ] Tono pratico‑operativo, vendor‑neutral.
                    \n ### sys_source https://chatgpt.com/c/68b73c35-0298-8328-a7b9-76f473241645
                \n Popola questo schema
                \n <output_schema>
                \n {"$schema":"http://json-schema.org/draft-07/schema#","type":"object","additionalProperties":false,"required":["meta","ambito"],"properties":{"meta":{"type":"object","additionalProperties":false,"required":["db_name","version","last_updated","language","notes"],"properties":{"db_name":{"type":"string"},"version":{"type":"string"},"last_updated":{"type":"string"},"language":{"type":"string"},"notes":{"type":"string"}}},"ambito":{"type":"object","additionalProperties":false,"required":["id","nome","ruolo","descrizione","sezioni"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"ruolo":{"type":"string"},"norme_riferimento":{"type":"array","items":{"type":"string"}},"descrizione":{"type":"string"},"sezioni":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/sezione"}}}}},"$defs":{"sezione":{"type":"object","additionalProperties":false,"required":["id","nome","obiettivo","output_attesi","prompt_base","aspetti_di_sicurezza","policy_template","sop_template","repo_branching_model","raci","parametri_generazione","prompting","checklist","campi_contesto_richiesti_per_la_contestualizzazione","avvertenze"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"obiettivo":{"type":"object","additionalProperties":false,"required":["codice","descrizione"],"properties":{"codice":{"type":"string"},"descrizione":{"type":"string"}}},"output_attesi":{"type":"array","items":{"type":"string"}},"prompt_base":{"type":"string"},"aspetti_di_sicurezza":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/aspetto"}},"policy_template":{"$ref":"#/$defs/policy_template"},"sop_template":{"$ref":"#/$defs/sop_template"},"repo_branching_model":{"type":"object","additionalProperties":false,"required":["modello","regole"],"properties":{"modello":{"type":"string"},"regole":{"type":"array","items":{"type":"string"}}}},"raci":{"type":"object","additionalProperties":false,"required":["roles","matrix"],"properties":{"roles":{"type":"array","minItems":1,"items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["attivita"],"properties":{"attivita":{"type":"string"},"SP":{"type":"string"},"AO":{"type":"string"},"SI":{"type":"string"},"OTSec":{"type":"string"}}}}}},"parametri_generazione":{"type":"object","additionalProperties":false,"required":["tipi_documento_supportati","audience_possibili","stili","livello_tecnico","vincoli"],"properties":{"tipi_documento_supportati":{"type":"array","items":{"type":"string"}},"audience_possibili":{"type":"array","items":{"type":"string"}},"stili":{"type":"array","items":{"type":"string"}},"livello_tecnico":{"type":"array","items":{"type":"string"}},"vincoli":{"type":"array","items":{"type":"string"}}}},"prompting":{"type":"object","additionalProperties":false,"required":["prompt_template_generico","prompt_esempio_articolo","prompt_esempio_slide","prompt_esempio_sop"],"properties":{"prompt_template_generico":{"type":"string"},"prompt_esempio_articolo":{"type":"string"},"prompt_esempio_slide":{"type":"string"},"prompt_esempio_sop":{"type":"string"}}},"checklist":{"type":"array","items":{"type":"string"}},"campi_contesto_richiesti_per_la_contestualizzazione":{"type":"array","items":{"type":"string"}},"avvertenze":{"type":"array","items":{"type":"string"}}}},"aspetto":{"type":"object","additionalProperties":false,"required":["id","titolo","descrizione_astratta","rischi_mitigati","pratiche_raccomandate","metriche_kpi","artefatti","placeholders_contesto"],"properties":{"id":{"type":"string"},"titolo":{"type":"string"},"descrizione_astratta":{"type":"string"},"rischi_mitigati":{"type":"array","items":{"type":"string"}},"pratiche_raccomandate":{"type":"array","items":{"type":"string"}},"metriche_kpi":{"type":"array","items":{"type":"string"}},"artefatti":{"type":"object","additionalProperties":false,"required":["procedure","registri","evidenze"],"properties":{"procedure":{"type":"array","items":{"type":"string"}},"registri":{"type":"array","items":{"type":"string"}},"evidenze":{"type":"array","items":{"type":"string"}}}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"policy_template":{"type":"object","additionalProperties":false,"required":["titolo","sezioni","placeholders_contesto"],"properties":{"titolo":{"type":"string"},"sezioni":{"type":"array","items":{"type":"string"}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"sop_template":{"type":"object","additionalProperties":false,"required":["titolo","step","registrazioni"],"properties":{"titolo":{"type":"string"},"step":{"type":"array","items":{"type":"string"}},"registrazioni":{"type":"array","items":{"type":"string"}}}}}}
                \n </output_schema>
    call Identità, accessi e audit (**FR1 — IAC; FR2 — UC**)
        llm_service grok
        llm_model grok-3
        max_tokens 8192
        temperature 0.2
        description normative_e_standard - Identità, accessi e audit (**FR1 — IAC; FR2 — UC**)
        message 
            role system
            content 
                \n Sei un assistente che genera SOLO JSON UTF-8 valido, senza testo fuori dal JSON.
                \n Sei un esperto di cybersecurity in contesto OT/ICS
                \n Conosci particolarmente bene lo standard di sicurezza IEC 62443.
                \n Conosci anche IEC 27001/2, Nis2, CRA, Direttiva macchine 2006, Registro Macchine 2023 e GDPR 2016.
        message 
            role user
            content 
                \n Genera il “DB Argomenti” seguendo lo schema richiesto. Parametri:
                \n meta:
                \n db_name: "DB Argomenti OT/ICS Cybersecurity"
                \n version: "0.1"
                \n language: "it-IT"
                \n notes: "Database orientato a oggetti su tre livelli. Contenuti ad alto livello con placeholders di contesto."
                \n ambito:
                \n id: "cap/5"
                \n nome: "Misure tecniche e organizzative (IEC 62443)"
                \n sezione:
                \n id: "cap/5/5.1"
                \n nome: "Identità, accessi e audit (**FR1 — IAC; FR2 — UC**)"
                \n descrizione:
                    \n **Contenuti da coprire**
                    \n * **Account nominali** (no *shared*), **least privilege**, **MFA** (autenticazione a più fattori) per conduits remoti e operazioni critiche.
                    \n * **RBAC** (controllo accessi basato su ruoli) separando **ruoli OT** da **ruoli IT**.
                    \n * **Privileged Access** via **jump host/broker**; **time‑bound approval**, **two‑person rule** per attività critiche.
                    \n * **Service account**: uso minimo, rotazione segreta, vault.
                    \n * **Audit trail** centralizzato (chi, cosa, quando) e **session recording** per accessi remoti.
                    \n * Gestione **break‑glass** (emergenza) con post‑review.
                    \n **Figure/Template (segnaposto)**
                    \n * **Figura [section]**: Architettura **privileged access** con broker.
                    \n * **Tabella [section]**: Matrice **ruolo→permessi** (RBAC) per ruoli OT.
                \n obiettivo:
                    \n Gestire **identità** (chi sei), **autorizzazioni** (cosa puoi fare) e **audit** (traccia) nell’OT.
                \n output:
                    \n Policy **Identity & Access OT**; matrice **ruolo→permessi**; flusso approvazione; registro audit.
                \n prompt_base:
                    \n Scrivi 12–14 righe su identità, autorizzazioni e audit in OT (FR1‑FR2): account nominali, RBAC, MFA, privilegi tramite broker, session recording e break‑glass con post‑review.
                \n Popola questo schema
                \n <output_schema>
                \n {"$schema":"http://json-schema.org/draft-07/schema#","type":"object","additionalProperties":false,"required":["meta","ambito"],"properties":{"meta":{"type":"object","additionalProperties":false,"required":["db_name","version","last_updated","language","notes"],"properties":{"db_name":{"type":"string"},"version":{"type":"string"},"last_updated":{"type":"string"},"language":{"type":"string"},"notes":{"type":"string"}}},"ambito":{"type":"object","additionalProperties":false,"required":["id","nome","ruolo","descrizione","sezioni"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"ruolo":{"type":"string"},"norme_riferimento":{"type":"array","items":{"type":"string"}},"descrizione":{"type":"string"},"sezioni":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/sezione"}}}}},"$defs":{"sezione":{"type":"object","additionalProperties":false,"required":["id","nome","obiettivo","output_attesi","prompt_base","aspetti_di_sicurezza","policy_template","sop_template","repo_branching_model","raci","parametri_generazione","prompting","checklist","campi_contesto_richiesti_per_la_contestualizzazione","avvertenze"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"obiettivo":{"type":"object","additionalProperties":false,"required":["codice","descrizione"],"properties":{"codice":{"type":"string"},"descrizione":{"type":"string"}}},"output_attesi":{"type":"array","items":{"type":"string"}},"prompt_base":{"type":"string"},"aspetti_di_sicurezza":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/aspetto"}},"policy_template":{"$ref":"#/$defs/policy_template"},"sop_template":{"$ref":"#/$defs/sop_template"},"repo_branching_model":{"type":"object","additionalProperties":false,"required":["modello","regole"],"properties":{"modello":{"type":"string"},"regole":{"type":"array","items":{"type":"string"}}}},"raci":{"type":"object","additionalProperties":false,"required":["roles","matrix"],"properties":{"roles":{"type":"array","minItems":1,"items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["attivita"],"properties":{"attivita":{"type":"string"},"SP":{"type":"string"},"AO":{"type":"string"},"SI":{"type":"string"},"OTSec":{"type":"string"}}}}}},"parametri_generazione":{"type":"object","additionalProperties":false,"required":["tipi_documento_supportati","audience_possibili","stili","livello_tecnico","vincoli"],"properties":{"tipi_documento_supportati":{"type":"array","items":{"type":"string"}},"audience_possibili":{"type":"array","items":{"type":"string"}},"stili":{"type":"array","items":{"type":"string"}},"livello_tecnico":{"type":"array","items":{"type":"string"}},"vincoli":{"type":"array","items":{"type":"string"}}}},"prompting":{"type":"object","additionalProperties":false,"required":["prompt_template_generico","prompt_esempio_articolo","prompt_esempio_slide","prompt_esempio_sop"],"properties":{"prompt_template_generico":{"type":"string"},"prompt_esempio_articolo":{"type":"string"},"prompt_esempio_slide":{"type":"string"},"prompt_esempio_sop":{"type":"string"}}},"checklist":{"type":"array","items":{"type":"string"}},"campi_contesto_richiesti_per_la_contestualizzazione":{"type":"array","items":{"type":"string"}},"avvertenze":{"type":"array","items":{"type":"string"}}}},"aspetto":{"type":"object","additionalProperties":false,"required":["id","titolo","descrizione_astratta","rischi_mitigati","pratiche_raccomandate","metriche_kpi","artefatti","placeholders_contesto"],"properties":{"id":{"type":"string"},"titolo":{"type":"string"},"descrizione_astratta":{"type":"string"},"rischi_mitigati":{"type":"array","items":{"type":"string"}},"pratiche_raccomandate":{"type":"array","items":{"type":"string"}},"metriche_kpi":{"type":"array","items":{"type":"string"}},"artefatti":{"type":"object","additionalProperties":false,"required":["procedure","registri","evidenze"],"properties":{"procedure":{"type":"array","items":{"type":"string"}},"registri":{"type":"array","items":{"type":"string"}},"evidenze":{"type":"array","items":{"type":"string"}}}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"policy_template":{"type":"object","additionalProperties":false,"required":["titolo","sezioni","placeholders_contesto"],"properties":{"titolo":{"type":"string"},"sezioni":{"type":"array","items":{"type":"string"}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"sop_template":{"type":"object","additionalProperties":false,"required":["titolo","step","registrazioni"],"properties":{"titolo":{"type":"string"},"step":{"type":"array","items":{"type":"string"}},"registrazioni":{"type":"array","items":{"type":"string"}}}}}}
                \n </output_schema>
    call Hardening & Configuration Management (**FR3 — SI**)
        llm_service grok
        llm_model grok-3
        max_tokens 8192
        temperature 0.2
        description normative_e_standard - Hardening & Configuration Management (**FR3 — SI**)
        message 
            role system
            content 
                \n Sei un assistente che genera SOLO JSON UTF-8 valido, senza testo fuori dal JSON.
                \n Sei un esperto di cybersecurity in contesto OT/ICS
                \n Conosci particolarmente bene lo standard di sicurezza IEC 62443.
                \n Conosci anche IEC 27001/2, Nis2, CRA, Direttiva macchine 2006, Registro Macchine 2023 e GDPR 2016.
        message 
            role user
            content 
                \n Genera il “DB Argomenti” seguendo lo schema richiesto. Parametri:
                \n meta:
                \n db_name: "DB Argomenti OT/ICS Cybersecurity"
                \n version: "0.1"
                \n language: "it-IT"
                \n notes: "Database orientato a oggetti su tre livelli. Contenuti ad alto livello con placeholders di contesto."
                \n ambito:
                \n id: "cap/5"
                \n nome: "Misure tecniche e organizzative (IEC 62443)"
                \n sezione:
                \n id: "cap/5/5.2"
                \n nome: "Hardening & Configuration Management (**FR3 — SI**)"
                \n descrizione:
                    \n **Contenuti da coprire**
                    \n * **Baseline** per sistemi operativi OT, HMI/engineering, PLC‑gateway, server dell’impianto.
                    \n * Disabilitare servizi/porte **non necessari**; impostare criteri **secure‑by‑default**.
                    \n * **Configurazioni versionate** (repository), **golden image**, controllo **change** con approvazione (‑2‑1).
                    \n * **Application allow‑listing** (solo software autorizzato) ove fattibile in OT.
                    \n * **Backup** delle configurazioni prima/after change; **rollback plan**.
                    \n * Check di **integrità** (hash/firma) di firmware/immagini.
                    \n **Figure/Template (segnaposto)**
                    \n * **Tabella [section]**: Checklist **hardening per asset** (HMI, server, gateway, ecc.).
                    \n * **Figura [section]**: Flusso **change→backup→deploy→rollback**.
                \n obiettivo:
                    \n Definire **baseline di hardening** e controlli di **configurazione** per ridurre la superficie d’attacco OT.
                \n output:
                    \n Standard di hardening; **checklist** per tipo di asset; repository versionato delle configurazioni.
                \n prompt_base:
                    \n Redigi 10–12 righe su hardening e gestione configurazioni (FR3): baseline per asset OT, servizi minimi, versioning, golden image, allow‑listing e piani di rollback.
                \n Popola questo schema
                \n <output_schema>
                \n {"$schema":"http://json-schema.org/draft-07/schema#","type":"object","additionalProperties":false,"required":["meta","ambito"],"properties":{"meta":{"type":"object","additionalProperties":false,"required":["db_name","version","last_updated","language","notes"],"properties":{"db_name":{"type":"string"},"version":{"type":"string"},"last_updated":{"type":"string"},"language":{"type":"string"},"notes":{"type":"string"}}},"ambito":{"type":"object","additionalProperties":false,"required":["id","nome","ruolo","descrizione","sezioni"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"ruolo":{"type":"string"},"norme_riferimento":{"type":"array","items":{"type":"string"}},"descrizione":{"type":"string"},"sezioni":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/sezione"}}}}},"$defs":{"sezione":{"type":"object","additionalProperties":false,"required":["id","nome","obiettivo","output_attesi","prompt_base","aspetti_di_sicurezza","policy_template","sop_template","repo_branching_model","raci","parametri_generazione","prompting","checklist","campi_contesto_richiesti_per_la_contestualizzazione","avvertenze"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"obiettivo":{"type":"object","additionalProperties":false,"required":["codice","descrizione"],"properties":{"codice":{"type":"string"},"descrizione":{"type":"string"}}},"output_attesi":{"type":"array","items":{"type":"string"}},"prompt_base":{"type":"string"},"aspetti_di_sicurezza":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/aspetto"}},"policy_template":{"$ref":"#/$defs/policy_template"},"sop_template":{"$ref":"#/$defs/sop_template"},"repo_branching_model":{"type":"object","additionalProperties":false,"required":["modello","regole"],"properties":{"modello":{"type":"string"},"regole":{"type":"array","items":{"type":"string"}}}},"raci":{"type":"object","additionalProperties":false,"required":["roles","matrix"],"properties":{"roles":{"type":"array","minItems":1,"items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["attivita"],"properties":{"attivita":{"type":"string"},"SP":{"type":"string"},"AO":{"type":"string"},"SI":{"type":"string"},"OTSec":{"type":"string"}}}}}},"parametri_generazione":{"type":"object","additionalProperties":false,"required":["tipi_documento_supportati","audience_possibili","stili","livello_tecnico","vincoli"],"properties":{"tipi_documento_supportati":{"type":"array","items":{"type":"string"}},"audience_possibili":{"type":"array","items":{"type":"string"}},"stili":{"type":"array","items":{"type":"string"}},"livello_tecnico":{"type":"array","items":{"type":"string"}},"vincoli":{"type":"array","items":{"type":"string"}}}},"prompting":{"type":"object","additionalProperties":false,"required":["prompt_template_generico","prompt_esempio_articolo","prompt_esempio_slide","prompt_esempio_sop"],"properties":{"prompt_template_generico":{"type":"string"},"prompt_esempio_articolo":{"type":"string"},"prompt_esempio_slide":{"type":"string"},"prompt_esempio_sop":{"type":"string"}}},"checklist":{"type":"array","items":{"type":"string"}},"campi_contesto_richiesti_per_la_contestualizzazione":{"type":"array","items":{"type":"string"}},"avvertenze":{"type":"array","items":{"type":"string"}}}},"aspetto":{"type":"object","additionalProperties":false,"required":["id","titolo","descrizione_astratta","rischi_mitigati","pratiche_raccomandate","metriche_kpi","artefatti","placeholders_contesto"],"properties":{"id":{"type":"string"},"titolo":{"type":"string"},"descrizione_astratta":{"type":"string"},"rischi_mitigati":{"type":"array","items":{"type":"string"}},"pratiche_raccomandate":{"type":"array","items":{"type":"string"}},"metriche_kpi":{"type":"array","items":{"type":"string"}},"artefatti":{"type":"object","additionalProperties":false,"required":["procedure","registri","evidenze"],"properties":{"procedure":{"type":"array","items":{"type":"string"}},"registri":{"type":"array","items":{"type":"string"}},"evidenze":{"type":"array","items":{"type":"string"}}}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"policy_template":{"type":"object","additionalProperties":false,"required":["titolo","sezioni","placeholders_contesto"],"properties":{"titolo":{"type":"string"},"sezioni":{"type":"array","items":{"type":"string"}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"sop_template":{"type":"object","additionalProperties":false,"required":["titolo","step","registrazioni"],"properties":{"titolo":{"type":"string"},"step":{"type":"array","items":{"type":"string"}},"registrazioni":{"type":"array","items":{"type":"string"}}}}}}
                \n </output_schema>
    call Logging & Monitoring (**FR6 — TRE**)
        llm_service grok
        llm_model grok-3
        max_tokens 8192
        temperature 0.2
        description normative_e_standard - Logging & Monitoring (**FR6 — TRE**)
        message 
            role system
            content 
                \n Sei un assistente che genera SOLO JSON UTF-8 valido, senza testo fuori dal JSON.
                \n Sei un esperto di cybersecurity in contesto OT/ICS
                \n Conosci particolarmente bene lo standard di sicurezza IEC 62443.
                \n Conosci anche IEC 27001/2, Nis2, CRA, Direttiva macchine 2006, Registro Macchine 2023 e GDPR 2016.
        message 
            role user
            content 
                \n Genera il “DB Argomenti” seguendo lo schema richiesto. Parametri:
                \n meta:
                \n db_name: "DB Argomenti OT/ICS Cybersecurity"
                \n version: "0.1"
                \n language: "it-IT"
                \n notes: "Database orientato a oggetti su tre livelli. Contenuti ad alto livello con placeholders di contesto."
                \n ambito:
                \n id: "cap/5"
                \n nome: "Misure tecniche e organizzative (IEC 62443)"
                \n sezione:
                \n id: "cap/5/5.3"
                \n nome: "Logging & Monitoring (**FR6 — TRE**)"
                \n descrizione:
                    \n **Contenuti da coprire**
                    \n * Sorgenti: **OT firewall**, switch, **IDS OT**, HMI/engineering, server OT, sistemi AV/EDR compatibili OT.
                    \n * **Centralizzazione** log, **retention** (es. > 90 gg), orari sincronizzati (**NTP**).
                    \n * Use case minimi: accessi remoti, cambi configurazione, protocolli OT **non whitelisted**, perdita comunicazioni, allarmi safety.
                    \n * **Runbook** di triage/risposta; integrazione con **SOC** (Security Operations Center).
                    \n * **Test** periodici e tuning dei falsi positivi.
                    \n **Figure/Template (segnaposto)**
                    \n * **Figura [section]**: Flusso raccolta log → analisi → risposta.
                    \n * **Tabella [section]**: Use case minimi e log richiesti.
                \n obiettivo:
                    \n Raccogliere **log/telemetria** e attivare **use case** di rilevazione/risposta agli eventi OT.
                \n output:
                    \n Piano **logging & monitoring**; elenco use case e runbook; cruscotto **KPI** (MTTD).
                \n prompt_base:
                    \n Scrivi 10–12 righe su logging/monitoring (FR6): sorgenti log OT, centralizzazione, use case minimi e runbook con integrazione SOC.
                \n Popola questo schema
                \n <output_schema>
                \n {"$schema":"http://json-schema.org/draft-07/schema#","type":"object","additionalProperties":false,"required":["meta","ambito"],"properties":{"meta":{"type":"object","additionalProperties":false,"required":["db_name","version","last_updated","language","notes"],"properties":{"db_name":{"type":"string"},"version":{"type":"string"},"last_updated":{"type":"string"},"language":{"type":"string"},"notes":{"type":"string"}}},"ambito":{"type":"object","additionalProperties":false,"required":["id","nome","ruolo","descrizione","sezioni"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"ruolo":{"type":"string"},"norme_riferimento":{"type":"array","items":{"type":"string"}},"descrizione":{"type":"string"},"sezioni":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/sezione"}}}}},"$defs":{"sezione":{"type":"object","additionalProperties":false,"required":["id","nome","obiettivo","output_attesi","prompt_base","aspetti_di_sicurezza","policy_template","sop_template","repo_branching_model","raci","parametri_generazione","prompting","checklist","campi_contesto_richiesti_per_la_contestualizzazione","avvertenze"],"properties":{"id":{"type":"string"},"nome":{"type":"string"},"obiettivo":{"type":"object","additionalProperties":false,"required":["codice","descrizione"],"properties":{"codice":{"type":"string"},"descrizione":{"type":"string"}}},"output_attesi":{"type":"array","items":{"type":"string"}},"prompt_base":{"type":"string"},"aspetti_di_sicurezza":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/aspetto"}},"policy_template":{"$ref":"#/$defs/policy_template"},"sop_template":{"$ref":"#/$defs/sop_template"},"repo_branching_model":{"type":"object","additionalProperties":false,"required":["modello","regole"],"properties":{"modello":{"type":"string"},"regole":{"type":"array","items":{"type":"string"}}}},"raci":{"type":"object","additionalProperties":false,"required":["roles","matrix"],"properties":{"roles":{"type":"array","minItems":1,"items":{"type":"string"}},"matrix":{"type":"array","items":{"type":"object","additionalProperties":false,"required":["attivita"],"properties":{"attivita":{"type":"string"},"SP":{"type":"string"},"AO":{"type":"string"},"SI":{"type":"string"},"OTSec":{"type":"string"}}}}}},"parametri_generazione":{"type":"object","additionalProperties":false,"required":["tipi_documento_supportati","audience_possibili","stili","livello_tecnico","vincoli"],"properties":{"tipi_documento_supportati":{"type":"array","items":{"type":"string"}},"audience_possibili":{"type":"array","items":{"type":"string"}},"stili":{"type":"array","items":{"type":"string"}},"livello_tecnico":{"type":"array","items":{"type":"string"}},"vincoli":{"type":"array","items":{"type":"string"}}}},"prompting":{"type":"object","additionalProperties":false,"required":["prompt_template_generico","prompt_esempio_articolo","prompt_esempio_slide","prompt_esempio_sop"],"properties":{"prompt_template_generico":{"type":"string"},"prompt_esempio_articolo":{"type":"string"},"prompt_esempio_slide":{"type":"string"},"prompt_esempio_sop":{"type":"string"}}},"checklist":{"type":"array","items":{"type":"string"}},"campi_contesto_richiesti_per_la_contestualizzazione":{"type":"array","items":{"type":"string"}},"avvertenze":{"type":"array","items":{"type":"string"}}}},"aspetto":{"type":"object","additionalProperties":false,"required":["id","titolo","descrizione_astratta","rischi_mitigati","pratiche_raccomandate","metriche_kpi","artefatti","placeholders_contesto"],"properties":{"id":{"type":"string"},"titolo":{"type":"string"},"descrizione_astratta":{"type":"string"},"rischi_mitigati":{"type":"array","items":{"type":"string"}},"pratiche_raccomandate":{"type":"array","items":{"type":"string"}},"metriche_kpi":{"type":"array","items":{"type":"string"}},"artefatti":{"type":"object","additionalProperties":false,"required":["procedure","registri","evidenze"],"properties":{"procedure":{"type":"array","items":{"type":"string"}},"registri":{"type":"array","items":{"type":"string"}},"evidenze":{"type":"array","items":{"type":"string"}}}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"policy_template":{"type":"object","additionalProperties":false,"required":["titolo","sezioni","placeholders_contesto"],"properties":{"titolo":{"type":"string"},"sezioni":{"type":"array","items":{"type":"string"}},"placeholders_contesto":{"type":"array","items":{"type":"string"}}}},"sop_template":{"type":"object","additionalProperties":false,"required":["titolo","step","registrazioni"],"properties":{"titolo":{"type":"string"},"step":{"type":"array","items":{"type":"string"}},"registrazioni":{"type":"array","items":{"type":"string"}}}}}}
                \n </output_schema>