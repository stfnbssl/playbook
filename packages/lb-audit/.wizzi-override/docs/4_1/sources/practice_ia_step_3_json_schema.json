{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "description": "Generalized JSON schema for IEC 62443-4-1 practices",
  "required": ["practice", "code", "subCode", "name", "description", "details", "standard_compliance", "last_updated"],
  "properties": {
    "practice": {
      "type": "string",
      "description": "Numeric identifier of the practice within IEC 62443-4-1",
      "pattern": "^[0-9]+$"
    },
    "code": {
      "type": "string",
      "description": "Alphanumeric code for the practice (e.g., SG-7, SM-5)",
      "pattern": "^[A-Z]{2}-[0-9]+$"
    },
    "subCode": {
        "type": "string"
    },
    "name": {
      "type": "string",
      "description": "Name of the practice (e.g., Documentation review)",
      "minLength": 1
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the practice as per IEC 62443-4-1",
      "minLength": 1
    },
    "details": {
      "type": "object",
      "description": "Detailed information addressing key aspects of the practice",
      "required": [
        "risk_assessment_and_threat_modeling",
        "audit_and_compliance_verification",
        "training_and_competency_requirements",
        "tooling_and_automation_support",
        "handling_legacy_systems_and_constraints",
        "stakeholder_collaboration_and_governance",
        "continuous_improvement_and_updates"
      ],
      "properties": {
        "risk_assessment_and_threat_modeling": {
          "type": "object",
          "description": "Details for risk assessment and threat modeling related to the practice",
          "required": ["why", "methodologies", "tools", "case_study"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "methodologies": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "description"],
                "properties": {
                  "name": { "type": "string", "minLength": 1 },
                  "description": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "tools": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "purpose"],
                "properties": {
                  "name": { "type": "string", "minLength": 1 },
                  "purpose": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "case_study": {
              "type": "object",
              "required": ["example"],
              "properties": {
                "example": { "type": "string", "minLength": 1 }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "audit_and_compliance_verification": {
          "type": "object",
          "description": "Details for auditing and verifying compliance with the practice",
          "required": ["why", "audit_checklist", "metrics", "compliance_procedure"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "audit_checklist": {
              "type": "array",
              "items": { "type": "string", "minLength": 1 },
              "minItems": 1
            },
            "metrics": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["kpi", "target"],
                "properties": {
                  "kpi": { "type": "string", "minLength": 1 },
                  "target": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "compliance_procedure": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        },
        "training_and_competency_requirements": {
          "type": "object",
          "description": "Details for training and competency requirements",
          "required": ["why", "training_programs", "competency_assessment"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "training_programs": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "description"],
                "properties": {
                  "name": { "type": "string", "minLength": 1 },
                  "description": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "competency_assessment": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        },
        "tooling_and_automation_support": {
          "type": "object",
          "description": "Details for tools and automation supporting the practice",
          "required": ["why", "tools", "automation_strategy"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "tools": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "purpose"],
                "properties": {
                  "name": { "type": "string", "minLength": 1 },
                  "purpose": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "automation_strategy": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        },
        "handling_legacy_systems_and_constraints": {
          "type": "object",
          "description": "Details for addressing legacy systems in the practice",
          "required": ["why", "strategies", "example_policy"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "strategies": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["approach", "description"],
                "properties": {
                  "approach": { "type": "string", "minLength": 1 },
                  "description": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "example_policy": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        },
        "stakeholder_collaboration_and_governance": {
          "type": "object",
          "description": "Details for stakeholder collaboration and governance",
          "required": ["why", "governance_model", "conflict_resolution"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "governance_model": {
              "type": "object",
              "required": ["name", "roles"],
              "properties": {
                "name": { "type": "string", "minLength": 1 },
                "roles": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["role", "responsibility"],
                    "properties": {
                      "role": { "type": "string", "minLength": 1 },
                      "responsibility": { "type": "string", "minLength": 1 }
                    },
                    "additionalProperties": false
                  },
                  "minItems": 1
                }
              },
              "additionalProperties": false
            },
            "conflict_resolution": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        },
        "continuous_improvement_and_updates": {
          "type": "object",
          "description": "Details for continuous improvement and policy updates",
          "required": ["why", "update_process", "lessons_learned"],
          "properties": {
            "why": { "type": "string", "minLength": 1 },
            "update_process": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["step", "description"],
                "properties": {
                  "step": { "type": "string", "minLength": 1 },
                  "description": { "type": "string", "minLength": 1 }
                },
                "additionalProperties": false
              },
              "minItems": 1
            },
            "lessons_learned": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "standard_compliance": {
      "type": "string",
      "description": "Reference to the IEC 62443-4-1 standard",
      "enum": ["IEC 62443-4-1"]
    },
    "last_updated": {
      "type": "string",
      "description": "Date of last update in YYYY-MM-DD format",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    }
  },
  "additionalProperties": false
}